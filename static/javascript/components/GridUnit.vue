<template>
    <div>
        <div v-if="content.length==1">
            <input v-if="isEdit" v-model='fieldValue' v-on:keyup.stop="updateFormInput()" type="text" :name="name">
            <div v-else-if="name=='deviceStatus'">
                <div v-if="content[0]==null">No Device</div>
                <div v-else-if="content[0]" class="online">
                    <i class="fas fa-circle"></i>
                    Online
                </div>
                <div v-else class="offline">
                    <i class="fas fa-circle"></i>
                    Offline
                </div>
            </div>
            <span v-else>{{ content[0] }}</span>
        </div>
        <div v-else v-for="entry in content">
            <label style="font-weight: bold">{{ entry.label }}:</label>
            <grid-unit :content="[entry.value]" :is-edit="isEdit" :name="entry.key"></grid-unit>
        </div>
    </div>
</template>

<script>
    import bus from '../utils.communication.js'

    export default {
        name: "grid-unit",
        props: {
            content: Array,
            name: String,
            isEdit: Boolean
        },
        mounted: function () {
            if (!this.isEdit) {
                return
            }

            if (this.content.length > 1) {
                return
            }

            this.updateFormInput()
            bus.$on('clearForm', this.clearForm)
        },
        data: function () {
            return {
                fieldValue: ''
            }
        },
        methods: {
            updateFormInput: function () {
                let app = this.$root.$children[0]
                app.$data.formData[this.name] = this.fieldValue
            },
            clearForm: function () {
                this.fieldValue = ''
            }
        }
    }
</script>

<style scoped>
    .online {
        color: seagreen;
    }
    .offline {
        color: indianred;
    }
</style>
